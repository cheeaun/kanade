function microAjax(e,o){if(this.bindFunction=function(e,o){return function(){return e.apply(o,[o])}},this.stateChange=function(){4==this.request.readyState&&this.callbackFunction(this.request.responseText)},this.getRequest=function(){return window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest?new XMLHttpRequest:!1},this.postBody=arguments[2]||"",this.callbackFunction=o,this.url=e,this.request=this.getRequest(),this.request){var t=this.request;t.onreadystatechange=this.bindFunction(this.stateChange,this),""!==this.postBody?(t.open("POST",e,!0),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.setRequestHeader("Connection","close")):t.open("GET",e,!0),t.send(this.postBody)}}!function(e,o){"undefined"!=typeof module?module.exports=o():"function"==typeof define&&"object"==typeof define.amd?define(o):this[e]=o()}("kizzy",function(){function e(){}function o(){return+new Date}function t(e,t){e._[t]&&e._[t].e&&e._[t].e<o()&&e.remove(t)}function r(e){return"number"==typeof e&&isFinite(e)}function n(e){return localStorage[e]}function s(e,o){return localStorage[e]=o,o}function l(e){delete localStorage[e]}function a(){localStorage.clear()}function i(e){for(var o,t=Y.childNodes,r=null,n=0,s=t.length;s>n;n++)if(o=t.item(n),o.getAttribute("key")==e){r=o;break}return r}function c(e){var o=i(e),t=null;return o&&(t=o.getAttribute("value")),t}function p(e,o){var t=i(e);return t?t.setAttribute("value",o):(t=w.createNode(1,"item",""),t.setAttribute("key",e),t.setAttribute("value",o),Y.appendChild(t)),T.save(b),o}function u(e){i(e)&&Y.removeChild(node),T.save(b)}function d(){for(;Y.firstChild;)Y.removeChild(Y.firstChild);T.save(b)}function m(){this._={}}function h(e){this.ns=e,this._=JSON.parse(_(e)||"{}")}function f(e){return new h(e)}var S,v=document,b=v.domain,g=0,x=function(){return 1};try{S=!!localStorage||!!globalStorage,localStorage||(localStorage=globalStorage[b]),g=1}catch(y){g=0;try{if(v.documentElement.addBehavior){g=0,S=1;var T=v.documentElement;T.addBehavior("#default#userData"),T.load(b);var w=T.xmlDocument,Y=w.documentElement}}catch(C){S=!1}}var X=e,_=e,M=e,E=e;return S&&(X=g?s:p,_=g?n:c,M=g?l:u,E=g?a:d,x=function(e){try{var o=JSON.stringify(e._);return"{}"==o?M(e.ns):X(e.ns,o),1}catch(t){return 0}}),m.prototype={set:function(e,t,n){return this._[e]={value:t,e:r(n)?o()+n:0},x(this)||this.remove(e),t},get:function(e){return t(this,e),this._[e]?this._[e].value:void 0},remove:function(e){delete this._[e],x(this)},clear:function(){this._={},x(this)},clearExpireds:function(){for(var e in this._)t(this,e);x(this)}},h.prototype=m.prototype,f.remove=M,f.clear=E,f}),function(e,o){function t(e){return""===s?e:(e=e.charAt(0).toUpperCase()+e.substr(1),s+e)}var r=Math,n=o.createElement("div").style,s=function(){for(var e,o="t,webkitT,MozT,msT,OT".split(","),t=0,r=o.length;r>t;t++)if(e=o[t]+"ransform",e in n)return o[t].substr(0,o[t].length-1);return!1}(),l=s?"-"+s.toLowerCase()+"-":"",a=t("transform"),i=t("transitionProperty"),c=t("transitionDuration"),p=t("transformOrigin"),u=t("transitionTimingFunction"),d=t("transitionDelay"),m=/android/gi.test(navigator.appVersion),h=/iphone|ipad/gi.test(navigator.appVersion),f=/hp-tablet/gi.test(navigator.appVersion),S=t("perspective")in n,v="ontouchstart"in e&&!f,b=s!==!1,g=t("transition")in n,x="onorientationchange"in e?"orientationchange":"resize",y=v?"touchstart":"mousedown",T=v?"touchmove":"mousemove",w=v?"touchend":"mouseup",Y=v?"touchcancel":"mouseup",C=function(){if(s===!1)return!1;var e={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"otransitionend",ms:"MSTransitionEnd"};return e[s]}(),X=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){return setTimeout(e,1)}}(),_=function(){return e.cancelRequestAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||clearTimeout}(),M=S?" translateZ(0)":"",E=function(t,r){var n,s=this;s.wrapper="object"==typeof t?t:o.getElementById(t),s.wrapper.style.overflow="hidden",s.scroller=s.wrapper.children[0],s.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,handleClick:!0,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:m,hideScrollbar:h,fadeScrollbar:h&&S,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(e){e.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(n in r)s.options[n]=r[n];s.x=s.options.x,s.y=s.options.y,s.options.useTransform=b&&s.options.useTransform,s.options.hScrollbar=s.options.hScroll&&s.options.hScrollbar,s.options.vScrollbar=s.options.vScroll&&s.options.vScrollbar,s.options.zoom=s.options.useTransform&&s.options.zoom,s.options.useTransition=g&&s.options.useTransition,s.options.zoom&&m&&(M=""),s.scroller.style[i]=s.options.useTransform?l+"transform":"top left",s.scroller.style[c]="0",s.scroller.style[p]="0 0",s.options.useTransition&&(s.scroller.style[u]="cubic-bezier(0.33,0.66,0.66,1)"),s.options.useTransform?s.scroller.style[a]="translate("+s.x+"px,"+s.y+"px)"+M:s.scroller.style.cssText+=";position:absolute;top:"+s.y+"px;left:"+s.x+"px",s.options.useTransition&&(s.options.fixedScrollbar=!0),s.refresh(),s._bind(x,e),s._bind(y),v||"none"!=s.options.wheelAction&&(s._bind("DOMMouseScroll"),s._bind("mousewheel")),s.options.checkDOMChanges&&(s.checkDOMTime=setInterval(function(){s._checkDOMChanges()},500))};E.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(e){var o=this;switch(e.type){case y:if(!v&&0!==e.button)return;o._start(e);break;case T:o._move(e);break;case w:case Y:o._end(e);break;case x:o._resize();break;case"DOMMouseScroll":case"mousewheel":o._wheel(e);break;case C:o._transitionEnd(e)}},_checkDOMChanges:function(){this.moved||this.zoomed||this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale||this.refresh()},_scrollbar:function(e){var t,n=this;return n[e+"Scrollbar"]?(n[e+"ScrollbarWrapper"]||(t=o.createElement("div"),n.options.scrollbarClass?t.className=n.options.scrollbarClass+e.toUpperCase():t.style.cssText="position:absolute;z-index:100;"+("h"==e?"height:7px;bottom:1px;left:2px;right:"+(n.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(n.hScrollbar?"7":"2")+"px;top:2px;right:1px"),t.style.cssText+=";pointer-events:none;"+l+"transition-property:opacity;"+l+"transition-duration:"+(n.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(n.options.hideScrollbar?"0":"1"),n.wrapper.appendChild(t),n[e+"ScrollbarWrapper"]=t,t=o.createElement("div"),n.options.scrollbarClass||(t.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);"+l+"background-clip:padding-box;"+l+"box-sizing:border-box;"+("h"==e?"height:100%":"width:100%")+";"+l+"border-radius:3px;border-radius:3px"),t.style.cssText+=";pointer-events:none;"+l+"transition-property:"+l+"transform;"+l+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);"+l+"transition-duration:0;"+l+"transform: translate(0,0)"+M,n.options.useTransition&&(t.style.cssText+=";"+l+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),n[e+"ScrollbarWrapper"].appendChild(t),n[e+"ScrollbarIndicator"]=t),"h"==e?(n.hScrollbarSize=n.hScrollbarWrapper.clientWidth,n.hScrollbarIndicatorSize=r.max(r.round(n.hScrollbarSize*n.hScrollbarSize/n.scrollerW),8),n.hScrollbarIndicator.style.width=n.hScrollbarIndicatorSize+"px",n.hScrollbarMaxScroll=n.hScrollbarSize-n.hScrollbarIndicatorSize,n.hScrollbarProp=n.hScrollbarMaxScroll/n.maxScrollX):(n.vScrollbarSize=n.vScrollbarWrapper.clientHeight,n.vScrollbarIndicatorSize=r.max(r.round(n.vScrollbarSize*n.vScrollbarSize/n.scrollerH),8),n.vScrollbarIndicator.style.height=n.vScrollbarIndicatorSize+"px",n.vScrollbarMaxScroll=n.vScrollbarSize-n.vScrollbarIndicatorSize,n.vScrollbarProp=n.vScrollbarMaxScroll/n.maxScrollY),n._scrollbarPos(e,!0),void 0):(n[e+"ScrollbarWrapper"]&&(b&&(n[e+"ScrollbarIndicator"].style[a]=""),n[e+"ScrollbarWrapper"].parentNode.removeChild(n[e+"ScrollbarWrapper"]),n[e+"ScrollbarWrapper"]=null,n[e+"ScrollbarIndicator"]=null),void 0)},_resize:function(){var e=this;setTimeout(function(){e.refresh()},m?200:0)},_pos:function(e,o){this.zoomed||(e=this.hScroll?e:0,o=this.vScroll?o:0,this.options.useTransform?this.scroller.style[a]="translate("+e+"px,"+o+"px) scale("+this.scale+")"+M:(e=r.round(e),o=r.round(o),this.scroller.style.left=e+"px",this.scroller.style.top=o+"px"),this.x=e,this.y=o,this._scrollbarPos("h"),this._scrollbarPos("v"))},_scrollbarPos:function(e,o){var t,n=this,s="h"==e?n.x:n.y;n[e+"Scrollbar"]&&(s=n[e+"ScrollbarProp"]*s,0>s?(n.options.fixedScrollbar||(t=n[e+"ScrollbarIndicatorSize"]+r.round(3*s),8>t&&(t=8),n[e+"ScrollbarIndicator"].style["h"==e?"width":"height"]=t+"px"),s=0):s>n[e+"ScrollbarMaxScroll"]&&(n.options.fixedScrollbar?s=n[e+"ScrollbarMaxScroll"]:(t=n[e+"ScrollbarIndicatorSize"]-r.round(3*(s-n[e+"ScrollbarMaxScroll"])),8>t&&(t=8),n[e+"ScrollbarIndicator"].style["h"==e?"width":"height"]=t+"px",s=n[e+"ScrollbarMaxScroll"]+(n[e+"ScrollbarIndicatorSize"]-t))),n[e+"ScrollbarWrapper"].style[d]="0",n[e+"ScrollbarWrapper"].style.opacity=o&&n.options.hideScrollbar?"0":"1",n[e+"ScrollbarIndicator"].style[a]="translate("+("h"==e?s+"px,0)":"0,"+s+"px)")+M)},_start:function(o){var t,n,s,l,i,c=this,p=v?o.touches[0]:o;c.enabled&&(c.options.onBeforeScrollStart&&c.options.onBeforeScrollStart.call(c,o),(c.options.useTransition||c.options.zoom)&&c._transitionTime(0),c.moved=!1,c.animating=!1,c.zoomed=!1,c.distX=0,c.distY=0,c.absDistX=0,c.absDistY=0,c.dirX=0,c.dirY=0,c.options.zoom&&v&&o.touches.length>1&&(l=r.abs(o.touches[0].pageX-o.touches[1].pageX),i=r.abs(o.touches[0].pageY-o.touches[1].pageY),c.touchesDistStart=r.sqrt(l*l+i*i),c.originX=r.abs(o.touches[0].pageX+o.touches[1].pageX-2*c.wrapperOffsetLeft)/2-c.x,c.originY=r.abs(o.touches[0].pageY+o.touches[1].pageY-2*c.wrapperOffsetTop)/2-c.y,c.options.onZoomStart&&c.options.onZoomStart.call(c,o)),c.options.momentum&&(c.options.useTransform?(t=getComputedStyle(c.scroller,null)[a].replace(/[^0-9\-.,]/g,"").split(","),n=+(t[12]||t[4]),s=+(t[13]||t[5])):(n=+getComputedStyle(c.scroller,null).left.replace(/[^0-9-]/g,""),s=+getComputedStyle(c.scroller,null).top.replace(/[^0-9-]/g,"")),(n!=c.x||s!=c.y)&&(c.options.useTransition?c._unbind(C):_(c.aniTime),c.steps=[],c._pos(n,s),c.options.onScrollEnd&&c.options.onScrollEnd.call(c))),c.absStartX=c.x,c.absStartY=c.y,c.startX=c.x,c.startY=c.y,c.pointX=p.pageX,c.pointY=p.pageY,c.startTime=o.timeStamp||Date.now(),c.options.onScrollStart&&c.options.onScrollStart.call(c,o),c._bind(T,e),c._bind(w,e),c._bind(Y,e))},_move:function(e){var o,t,n,s=this,l=v?e.touches[0]:e,i=l.pageX-s.pointX,c=l.pageY-s.pointY,p=s.x+i,u=s.y+c,d=e.timeStamp||Date.now();return s.options.onBeforeScrollMove&&s.options.onBeforeScrollMove.call(s,e),s.options.zoom&&v&&e.touches.length>1?(o=r.abs(e.touches[0].pageX-e.touches[1].pageX),t=r.abs(e.touches[0].pageY-e.touches[1].pageY),s.touchesDist=r.sqrt(o*o+t*t),s.zoomed=!0,n=1/s.touchesDistStart*s.touchesDist*this.scale,s.options.zoomMin>n?n=.5*s.options.zoomMin*Math.pow(2,n/s.options.zoomMin):n>s.options.zoomMax&&(n=2*s.options.zoomMax*Math.pow(.5,s.options.zoomMax/n)),s.lastScale=n/this.scale,p=this.originX-this.originX*s.lastScale+this.x,u=this.originY-this.originY*s.lastScale+this.y,this.scroller.style[a]="translate("+p+"px,"+u+"px) scale("+n+")"+M,s.options.onZoom&&s.options.onZoom.call(s,e),void 0):(s.pointX=l.pageX,s.pointY=l.pageY,(p>0||s.maxScrollX>p)&&(p=s.options.bounce?s.x+i/2:p>=0||s.maxScrollX>=0?0:s.maxScrollX),(u>s.minScrollY||s.maxScrollY>u)&&(u=s.options.bounce?s.y+c/2:u>=s.minScrollY||s.maxScrollY>=0?s.minScrollY:s.maxScrollY),s.distX+=i,s.distY+=c,s.absDistX=r.abs(s.distX),s.absDistY=r.abs(s.distY),6>s.absDistX&&6>s.absDistY||(s.options.lockDirection&&(s.absDistX>s.absDistY+5?(u=s.y,c=0):s.absDistY>s.absDistX+5&&(p=s.x,i=0)),s.moved=!0,s._pos(p,u),s.dirX=i>0?-1:0>i?1:0,s.dirY=c>0?-1:0>c?1:0,d-s.startTime>300&&(s.startTime=d,s.startX=s.x,s.startY=s.y),s.options.onScrollMove&&s.options.onScrollMove.call(s,e)),void 0)},_end:function(t){if(!v||0===t.touches.length){var n,s,l,i,p,u,d,m=this,h=v?t.changedTouches[0]:t,f={dist:0,time:0},S={dist:0,time:0},b=(t.timeStamp||Date.now())-m.startTime,g=m.x,x=m.y;if(m._unbind(T,e),m._unbind(w,e),m._unbind(Y,e),m.options.onBeforeScrollEnd&&m.options.onBeforeScrollEnd.call(m,t),m.zoomed)return d=m.scale*m.lastScale,d=Math.max(m.options.zoomMin,d),d=Math.min(m.options.zoomMax,d),m.lastScale=d/m.scale,m.scale=d,m.x=m.originX-m.originX*m.lastScale+m.x,m.y=m.originY-m.originY*m.lastScale+m.y,m.scroller.style[c]="200ms",m.scroller.style[a]="translate("+m.x+"px,"+m.y+"px) scale("+m.scale+")"+M,m.zoomed=!1,m.refresh(),m.options.onZoomEnd&&m.options.onZoomEnd.call(m,t),void 0;if(!m.moved)return v&&(m.doubleTapTimer&&m.options.zoom?(clearTimeout(m.doubleTapTimer),m.doubleTapTimer=null,m.options.onZoomStart&&m.options.onZoomStart.call(m,t),m.zoom(m.pointX,m.pointY,1==m.scale?m.options.doubleTapZoom:1),m.options.onZoomEnd&&setTimeout(function(){m.options.onZoomEnd.call(m,t)},200)):this.options.handleClick&&(m.doubleTapTimer=setTimeout(function(){for(m.doubleTapTimer=null,n=h.target;1!=n.nodeType;)n=n.parentNode;"SELECT"!=n.tagName&&"INPUT"!=n.tagName&&"TEXTAREA"!=n.tagName&&(s=o.createEvent("MouseEvents"),s.initMouseEvent("click",!0,!0,t.view,1,h.screenX,h.screenY,h.clientX,h.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,0,null),s._fake=!0,n.dispatchEvent(s))},m.options.zoom?250:0))),m._resetPos(400),m.options.onTouchEnd&&m.options.onTouchEnd.call(m,t),void 0;if(300>b&&m.options.momentum&&(f=g?m._momentum(g-m.startX,b,-m.x,m.scrollerW-m.wrapperW+m.x,m.options.bounce?m.wrapperW:0):f,S=x?m._momentum(x-m.startY,b,-m.y,0>m.maxScrollY?m.scrollerH-m.wrapperH+m.y-m.minScrollY:0,m.options.bounce?m.wrapperH:0):S,g=m.x+f.dist,x=m.y+S.dist,(m.x>0&&g>0||m.x<m.maxScrollX&&m.maxScrollX>g)&&(f={dist:0,time:0}),(m.y>m.minScrollY&&x>m.minScrollY||m.y<m.maxScrollY&&m.maxScrollY>x)&&(S={dist:0,time:0})),f.dist||S.dist)return p=r.max(r.max(f.time,S.time),10),m.options.snap&&(l=g-m.absStartX,i=x-m.absStartY,r.abs(l)<m.options.snapThreshold&&r.abs(i)<m.options.snapThreshold?m.scrollTo(m.absStartX,m.absStartY,200):(u=m._snap(g,x),g=u.x,x=u.y,p=r.max(u.time,p))),m.scrollTo(r.round(g),r.round(x),p),m.options.onTouchEnd&&m.options.onTouchEnd.call(m,t),void 0;if(m.options.snap)return l=g-m.absStartX,i=x-m.absStartY,r.abs(l)<m.options.snapThreshold&&r.abs(i)<m.options.snapThreshold?m.scrollTo(m.absStartX,m.absStartY,200):(u=m._snap(m.x,m.y),(u.x!=m.x||u.y!=m.y)&&m.scrollTo(u.x,u.y,u.time)),m.options.onTouchEnd&&m.options.onTouchEnd.call(m,t),void 0;m._resetPos(200),m.options.onTouchEnd&&m.options.onTouchEnd.call(m,t)}},_resetPos:function(e){var o=this,t=o.x>=0?0:o.x<o.maxScrollX?o.maxScrollX:o.x,r=o.y>=o.minScrollY||o.maxScrollY>0?o.minScrollY:o.y<o.maxScrollY?o.maxScrollY:o.y;return t==o.x&&r==o.y?(o.moved&&(o.moved=!1,o.options.onScrollEnd&&o.options.onScrollEnd.call(o)),o.hScrollbar&&o.options.hideScrollbar&&("webkit"==s&&(o.hScrollbarWrapper.style[d]="300ms"),o.hScrollbarWrapper.style.opacity="0"),o.vScrollbar&&o.options.hideScrollbar&&("webkit"==s&&(o.vScrollbarWrapper.style[d]="300ms"),o.vScrollbarWrapper.style.opacity="0"),void 0):(o.scrollTo(t,r,e||0),void 0)},_wheel:function(e){var o,t,r,n,s,l=this;if("wheelDeltaX"in e)o=e.wheelDeltaX/12,t=e.wheelDeltaY/12;else if("wheelDelta"in e)o=t=e.wheelDelta/12;else{if(!("detail"in e))return;o=t=3*-e.detail}return"zoom"==l.options.wheelAction?(s=l.scale*Math.pow(2,1/3*(t?t/Math.abs(t):0)),l.options.zoomMin>s&&(s=l.options.zoomMin),s>l.options.zoomMax&&(s=l.options.zoomMax),s!=l.scale&&(!l.wheelZoomCount&&l.options.onZoomStart&&l.options.onZoomStart.call(l,e),l.wheelZoomCount++,l.zoom(e.pageX,e.pageY,s,400),setTimeout(function(){l.wheelZoomCount--,!l.wheelZoomCount&&l.options.onZoomEnd&&l.options.onZoomEnd.call(l,e)},400)),void 0):(r=l.x+o,n=l.y+t,r>0?r=0:l.maxScrollX>r&&(r=l.maxScrollX),n>l.minScrollY?n=l.minScrollY:l.maxScrollY>n&&(n=l.maxScrollY),0>l.maxScrollY&&l.scrollTo(r,n,0),void 0)},_transitionEnd:function(e){var o=this;e.target==o.scroller&&(o._unbind(C),o._startAni())},_startAni:function(){var e,o,t,n=this,s=n.x,l=n.y,a=Date.now();if(!n.animating){if(!n.steps.length)return n._resetPos(400),void 0;if(e=n.steps.shift(),e.x==s&&e.y==l&&(e.time=0),n.animating=!0,n.moved=!0,n.options.useTransition)return n._transitionTime(e.time),n._pos(e.x,e.y),n.animating=!1,e.time?n._bind(C):n._resetPos(0),void 0;t=function(){var i,c,p=Date.now();return p>=a+e.time?(n._pos(e.x,e.y),n.animating=!1,n.options.onAnimationEnd&&n.options.onAnimationEnd.call(n),n._startAni(),void 0):(p=(p-a)/e.time-1,o=r.sqrt(1-p*p),i=(e.x-s)*o+s,c=(e.y-l)*o+l,n._pos(i,c),n.animating&&(n.aniTime=X(t)),void 0)},t()}},_transitionTime:function(e){e+="ms",this.scroller.style[c]=e,this.hScrollbar&&(this.hScrollbarIndicator.style[c]=e),this.vScrollbar&&(this.vScrollbarIndicator.style[c]=e)},_momentum:function(e,o,t,n,s){var l=6e-4,a=r.abs(e)/o,i=a*a/(2*l),c=0,p=0;return e>0&&i>t?(p=s/(6/(i/a*l)),t+=p,a=a*t/i,i=t):0>e&&i>n&&(p=s/(6/(i/a*l)),n+=p,a=a*n/i,i=n),i*=0>e?-1:1,c=a/l,{dist:i,time:r.round(c)}},_offset:function(e){for(var o=-e.offsetLeft,t=-e.offsetTop;e=e.offsetParent;)o-=e.offsetLeft,t-=e.offsetTop;return e!=this.wrapper&&(o*=this.scale,t*=this.scale),{left:o,top:t}},_snap:function(e,o){var t,n,s,l,a,i,c=this;for(s=c.pagesX.length-1,t=0,n=c.pagesX.length;n>t;t++)if(e>=c.pagesX[t]){s=t;break}for(s==c.currPageX&&s>0&&0>c.dirX&&s--,e=c.pagesX[s],a=r.abs(e-c.pagesX[c.currPageX]),a=a?500*(r.abs(c.x-e)/a):0,c.currPageX=s,s=c.pagesY.length-1,t=0;s>t;t++)if(o>=c.pagesY[t]){s=t;break}return s==c.currPageY&&s>0&&0>c.dirY&&s--,o=c.pagesY[s],i=r.abs(o-c.pagesY[c.currPageY]),i=i?500*(r.abs(c.y-o)/i):0,c.currPageY=s,l=r.round(r.max(a,i))||200,{x:e,y:o,time:l}},_bind:function(e,o,t){(o||this.scroller).addEventListener(e,this,!!t)},_unbind:function(e,o,t){(o||this.scroller).removeEventListener(e,this,!!t)},destroy:function(){var o=this;o.scroller.style[a]="",o.hScrollbar=!1,o.vScrollbar=!1,o._scrollbar("h"),o._scrollbar("v"),o._unbind(x,e),o._unbind(y),o._unbind(T,e),o._unbind(w,e),o._unbind(Y,e),o.options.hasTouch||(o._unbind("DOMMouseScroll"),o._unbind("mousewheel")),o.options.useTransition&&o._unbind(C),o.options.checkDOMChanges&&clearInterval(o.checkDOMTime),o.options.onDestroy&&o.options.onDestroy.call(o)},refresh:function(){var e,o,t,n,s=this,l=0,a=0;if(s.scale<s.options.zoomMin&&(s.scale=s.options.zoomMin),s.wrapperW=s.wrapper.clientWidth||1,s.wrapperH=s.wrapper.clientHeight||1,s.minScrollY=-s.options.topOffset||0,s.scrollerW=r.round(s.scroller.offsetWidth*s.scale),s.scrollerH=r.round((s.scroller.offsetHeight+s.minScrollY)*s.scale),s.maxScrollX=s.wrapperW-s.scrollerW,s.maxScrollY=s.wrapperH-s.scrollerH+s.minScrollY,s.dirX=0,s.dirY=0,s.options.onRefresh&&s.options.onRefresh.call(s),s.hScroll=s.options.hScroll&&0>s.maxScrollX,s.vScroll=s.options.vScroll&&(!s.options.bounceLock&&!s.hScroll||s.scrollerH>s.wrapperH),s.hScrollbar=s.hScroll&&s.options.hScrollbar,s.vScrollbar=s.vScroll&&s.options.vScrollbar&&s.scrollerH>s.wrapperH,e=s._offset(s.wrapper),s.wrapperOffsetLeft=-e.left,s.wrapperOffsetTop=-e.top,"string"==typeof s.options.snap)for(s.pagesX=[],s.pagesY=[],n=s.scroller.querySelectorAll(s.options.snap),o=0,t=n.length;t>o;o++)l=s._offset(n[o]),l.left+=s.wrapperOffsetLeft,l.top+=s.wrapperOffsetTop,s.pagesX[o]=l.left<s.maxScrollX?s.maxScrollX:l.left*s.scale,s.pagesY[o]=l.top<s.maxScrollY?s.maxScrollY:l.top*s.scale;else if(s.options.snap){for(s.pagesX=[];l>=s.maxScrollX;)s.pagesX[a]=l,l-=s.wrapperW,a++;for(s.maxScrollX%s.wrapperW&&(s.pagesX[s.pagesX.length]=s.maxScrollX-s.pagesX[s.pagesX.length-1]+s.pagesX[s.pagesX.length-1]),l=0,a=0,s.pagesY=[];l>=s.maxScrollY;)s.pagesY[a]=l,l-=s.wrapperH,a++;s.maxScrollY%s.wrapperH&&(s.pagesY[s.pagesY.length]=s.maxScrollY-s.pagesY[s.pagesY.length-1]+s.pagesY[s.pagesY.length-1])}s._scrollbar("h"),s._scrollbar("v"),s.zoomed||(s.scroller.style[c]="0",s._resetPos(400))},scrollTo:function(e,o,t,r){var n,s,l=this,a=e;for(l.stop(),a.length||(a=[{x:e,y:o,time:t,relative:r}]),n=0,s=a.length;s>n;n++)a[n].relative&&(a[n].x=l.x-a[n].x,a[n].y=l.y-a[n].y),l.steps.push({x:a[n].x,y:a[n].y,time:a[n].time||0});l._startAni()},scrollToElement:function(e,o){var t,n=this;e=e.nodeType?e:n.scroller.querySelector(e),e&&(t=n._offset(e),t.left+=n.wrapperOffsetLeft,t.top+=n.wrapperOffsetTop,t.left=t.left>0?0:t.left<n.maxScrollX?n.maxScrollX:t.left,t.top=t.top>n.minScrollY?n.minScrollY:t.top<n.maxScrollY?n.maxScrollY:t.top,o=void 0===o?r.max(2*r.abs(t.left),2*r.abs(t.top)):o,n.scrollTo(t.left,t.top,o))},scrollToPage:function(e,o,t){var r,n,s=this;t=void 0===t?400:t,s.options.onScrollStart&&s.options.onScrollStart.call(s),s.options.snap?(e="next"==e?s.currPageX+1:"prev"==e?s.currPageX-1:e,o="next"==o?s.currPageY+1:"prev"==o?s.currPageY-1:o,e=0>e?0:e>s.pagesX.length-1?s.pagesX.length-1:e,o=0>o?0:o>s.pagesY.length-1?s.pagesY.length-1:o,s.currPageX=e,s.currPageY=o,r=s.pagesX[e],n=s.pagesY[o]):(r=-s.wrapperW*e,n=-s.wrapperH*o,s.maxScrollX>r&&(r=s.maxScrollX),s.maxScrollY>n&&(n=s.maxScrollY)),s.scrollTo(r,n,t)},disable:function(){this.stop(),this._resetPos(0),this.enabled=!1,this._unbind(T,e),this._unbind(w,e),this._unbind(Y,e)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind(C):_(this.aniTime),this.steps=[],this.moved=!1,this.animating=!1},zoom:function(e,o,t,r){var n=this,s=t/n.scale;n.options.useTransform&&(n.zoomed=!0,r=void 0===r?200:r,e=e-n.wrapperOffsetLeft-n.x,o=o-n.wrapperOffsetTop-n.y,n.x=e-e*s+n.x,n.y=o-o*s+n.y,n.scale=t,n.refresh(),n.x=n.x>0?0:n.x<n.maxScrollX?n.maxScrollX:n.x,n.y=n.y>n.minScrollY?n.minScrollY:n.y<n.maxScrollY?n.maxScrollY:n.y,n.scroller.style[c]=r+"ms",n.scroller.style[a]="translate("+n.x+"px,"+n.y+"px) scale("+t+")"+M,n.zoomed=!1)},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}},n=null,"undefined"!=typeof exports?exports.iScroll=E:e.iScroll=E}(window,document),function(e,o){"function"==typeof define&&define.amd?define("tappable",[],function(){return o(e,window.document),e.tappable}):o(e,window.document)}(this,function(e,o){var t=(Math.abs,function(){}),r={noScroll:!1,activeClass:"tappable-active",onTap:t,onStart:t,onMove:t,onMoveOut:t,onMoveIn:t,onEnd:t,onCancel:t,allowClick:!1,boundMargin:50,noScrollDelay:0,activeClassDelay:0,inactiveClassDelay:0},n="ontouchend"in document,s={start:n?"touchstart":"mousedown",move:n?"touchmove":"mousemove",end:n?"touchend":"mouseup"},l=function(e,t){var r=o.elementFromPoint(e,t);return 3==r.nodeType&&(r=r.parentNode),r},a=function(e){var o=e.target;if(o)return 3==o.nodeType&&(o=o.parentNode),o;var t=e.targetTouches[0];return l(t.clientX,t.clientY)},i=function(e){return e.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"")},c=function(e,o){return o?e.classList?(e.classList.add(o),void 0):(i(e.className).indexOf(o)>-1||(e.className=i(e.className+" "+o)),void 0):void 0},p=function(e,o){return o?e.classList?(e.classList.remove(o),void 0):(e.className=e.className.replace(RegExp("(^|\\s)"+o+"(?:\\s|$)"),"$1"),void 0):void 0},u=function(e,t){var r=o.documentElement,n=r.matchesSelector||r.mozMatchesSelector||r.webkitMatchesSelector||r.oMatchesSelector||r.msMatchesSelector;return n.call(e,t)},d=function(e,o){var t=!1;do t=u(e,o);while(!t&&(e=e.parentNode)&&e.ownerDocument);return t?e:!1};e.tappable=function(e,t){"function"==typeof t&&(t={onTap:t});var n={};for(var i in r)n[i]=t[i]||r[i];var u,m,h,f,S,v,b,g,x=n.containerElement||o.body,y=!1,T=!1,w=n.activeClass,Y=n.activeClassDelay,C=n.inactiveClassDelay,X=n.noScroll,_=n.noScrollDelay,M=n.boundMargin,E=function(o){var t=d(a(o),e);if(t){if(Y?(clearTimeout(v),v=setTimeout(function(){c(t,w)},Y)):c(t,w),C&&t==m&&clearTimeout(b),h=o.clientX,f=o.clientY,!h||!f){var r=o.targetTouches[0];h=r.clientX,f=r.clientY}u=t,y=!1,T=!1,S=X?t.getBoundingClientRect():null,_&&(clearTimeout(g),X=!1,g=setTimeout(function(){X=!0},_)),n.onStart.call(x,o,t)}},z=function(e){if(u){X?e.preventDefault():clearTimeout(v);var o=e.target,t=e.clientX,r=e.clientY;if(!o||!t||!r){var s=e.changedTouches[0];t||(t=s.clientX),r||(r=s.clientY),o||(o=l(t,r))}X?t>S.left-M&&S.right+M>t&&r>S.top-M&&S.bottom+M>r?(T=!1,c(u,w),n.onMoveIn.call(x,e,o)):(T=!0,p(u,w),n.onMoveOut.call(x,e,o)):!y&&Math.abs(r-f)>10&&(y=!0,p(u,w),n.onCancel.call(o,e)),n.onMove.call(x,e,o)}},k=function(e){if(u){if(clearTimeout(v),C){Y&&!y&&c(u,w);var o=u;b=setTimeout(function(){p(o,w)},C)}else p(u,w);n.onEnd.call(x,e,u);var t=3==e.which||2==e.button;y||T||t||n.onTap.call(x,e,u),m=u,u=null,setTimeout(function(){h=f=null},400)}},D=function(e){u&&(p(u,w),u=h=f=null,n.onCancel.call(x,e))},L=function(o){var t=d(o.target,e);t?o.preventDefault():h&&f&&25>Math.abs(o.clientX-h)&&25>Math.abs(o.clientY-f)&&(o.stopPropagation(),o.preventDefault())};return x.addEventListener(s.start,E,!1),x.addEventListener(s.move,z,!1),x.addEventListener(s.end,k,!1),x.addEventListener("touchcancel",D,!1),n.allowClick||x.addEventListener("click",L,!1),{el:x,destroy:function(){return x.removeEventListener(s.start,E,!1),x.removeEventListener(s.move,z,!1),x.removeEventListener(s.end,k,!1),x.removeEventListener("touchcancel",D,!1),n.allowClick||x.removeEventListener("click",L,!1),this}}}}),function(e,o){var t="http://kanadeapi.appspot.com/v1/anime",r="http://myanimelist.net/anime/",n='<li id="anime-{id}"><div class="img"><img src="{image}" width="50" height="70" alt="" onerror="this.src = this.src+\'?\'+(+new Date())"></div><a href="{url}" target="_blank">{title}</a><span class="score {scoreColor}">{score}</span> <span class="episodes">{episodes} episodes</span><div class="genres">{genres}</div></li>',s=kizzy("animes"),l=function(e){return o.getElementById(e)},a=o.head||o.getElementsByTagName("head")[0],i=function(t,r,n){var s=o.createElement("script");e[r]=function(){n.apply(this,arguments),s.parentNode.removeChild(s),delete e[r]},s.async=1,s.src=t,a.insertBefore(s,a.firstChild)},c=function(e,o){return e.replace(/\\?\{([^{}]+)\}/g,function(e,t){return"\\"==e.charAt(0)?e.slice(1):null!=o[t]?o[t]:""})},p=function(){e.scrollTo(0,0)},u=null,d=[],m=/ip(?:ad|od|hone)/.test(navigator.userAgent.toLowerCase()),h="ontouchend"in document,f=l("heading-title"),S=(l("close-seasons"),l("close-image")),v=(l("container"),l("blank")),b=l("seasons-button"),g=l("seasons"),x=l("animes"),y=l("count"),T=(l("image"),l("image-caption"));loading=l("loading"),page={},scroll={},pages=o.querySelectorAll(".page"),hash=location.hash.slice(1),noop=function(){},$hide=function(e){e.setAttribute("data-position",e.style.position),e.style.position="absolute",e.style.clip="rect(0, 0, 0, 0)"},$show=function(e){e.style.position=e.getAttribute("data-position")||"",e.style.clip="auto"},clean=function(e){return e.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"")},hasClass=function(e,o){return clean(e.className).indexOf(o)>-1},addClass=function(e,o){hasClass(e,o)||(e.className=clean(e.className+" "+o))},removeClass=function(e,o){e.className=e.className.replace(RegExp("(^|\\s)"+o+"(?:\\s|$)"),"$1")},toggleClass=function(e,o){hasClass(e,o)?removeClass(e,o):addClass(e,o)},thumbSize=Math.round(50*(window.devicePixelRatio||1)),loadAnimes=function(e,o){var l=u[e][o],a=0,m=0,h=l.length,f=[],S=function(){if(m>=h){$hide(loading),d.sort(function(e,o){var t=o.score-e.score;return 0!=t?t:o.title<e.title});for(var e="",o=0;h>o;o++){var t=d[o],s=t.id,l=t.genres,a=parseFloat(t.score,10);e+=c(n,{id:s,url:r+s,image:"http://src.sencha.io/"+thumbSize+"/"+t.image,title:t.title,score:a.toFixed(2)||"?",scoreColor:10==a?"mad":a>=8?"good":a>=6?"ok":"",episodes:parseInt(t.episodes,10)||"?",genres:(l||[]).join(", ")})}x.innerHTML=e,y.innerHTML=h+" anime series.<br>Tip: Tap image to see larger version.",scroll.home.refresh(),scroll.home.scrollTo(0,0,350)}},b=function(){if(!(a>=f.length)){var e=f[a],o=e.split("/")[0],r="a"+o,n=t+"?id="+o+"&callback="+r,l=function(e){e&&(e.id=o,d.push(e),m++,S())},c=function(e){if(!e||!e.ok||!e.result)return i(n,r,c),void 0;var t=e.result;l(t),s.set(o,t,216e5)};i(n,r,c),setTimeout(b,250),a++}};$hide(v),$show(x),y.innerHTML="",$show(loading),x.innerHTML="",scroll.home.refresh(),d=[],p();for(var g=0;h>g;g++){var T=l[g],w=T.split("/")[0],Y=s.get(w);Y?(Y.id=w,d.push(Y),m++):f.push(T)}S(),f.length&&b()},h||addClass(document.body,"notouch");for(var w=0,Y=pages.length;Y>w;w++){var C=pages[w],X=C.id.replace("page-",""),_=C.querySelector(".scroll"),M={};switch(page[X]=C,X){case"home":var E,z,k=!1,D=function(){E&&(removeClass(E.parentNode,"selected"),E=null),z&&(removeClass(z,"active"),z=null)};M={hScroll:!1,onBeforeScrollStart:function(e){e.preventDefault();for(var o=e.target;1!=o.nodeType;)o=o.parentNode;var t=o.tagName.toLowerCase();if("img"==t){var r=o.parentNode;if(hasClass(r,"selected"))return;E=o,addClass(r,"selected")}else"a"==t&&(z=o,addClass(o,"active"))},onBeforeScrollMove:function(){k=!0,D()},onScrollEnd:function(){k=!1},onTouchEnd:function(){if(E){var e=E,t=page.image;$show(t),removeClass(t,"slideup"),removeClass(t,"out"),removeClass(t,"reverse"),addClass(t,"slideup in");var r=s.get(e.parentNode.parentNode.id.split("-")[1])||{title:""},n=t.querySelector(".scroll div"),l=new Image,a=r.image.replace(".jpg","l.jpg");o.createElement("p"),l.onload=function(){removeClass(l,"loading"),n.style.minWidth=Math.max(window.innerWidth,l.offsetWidth)+"px",setTimeout(function(){scroll.image.refresh()},100)},l.onabort=l.onerror=function(){l.src=a+"?"+ +new Date},l.src=a,l.alt="",addClass(l,"loading"),T.innerHTML=t.querySelector("h1").innerHTML=r.title,addClass(t.querySelector("header"),"visible"),addClass(T,"visible"),n.appendChild(l),n.style.width="",scroll.image.scrollTo(0,0),scroll.image.zoom(0,0,1),scroll.image.refresh()}setTimeout(D,350)}};break;case"seasons":var L,q,k=!1;M={hScroll:!1,onBeforeScrollStart:function(e){e.preventDefault();for(var o=e.target;1!=o.nodeType;)o=o.parentNode;"a"==o.tagName.toLowerCase()&&(L=o,clearTimeout(q),q=setTimeout(function(){addClass(L,"selected")},80))},onBeforeScrollMove:function(){L&&(k=!0,clearTimeout(q),removeClass(L,"selected"))},onScrollEnd:function(){k=!1},onTouchEnd:function(){if(L)if(k)clearTimeout(q),setTimeout(function(){removeClass(L,"selected")},2e3);else{var o=page.seasons;addClass(L,"selected"),e.innerWidth>=481?setTimeout(function(){removeClass(L,"selected")},350):setTimeout(function(){removeClass(o,"in"),addClass(o,"slideup out reverse"),setTimeout(function(){removeClass(L,"selected")},350)},600)}}};break;case"image":var H=C.querySelector("header"),k=!1,A=!1;M={hScroll:!0,hScrollbar:!1,vScrollbar:!1,zoom:!0,lockDirection:!1,onScrollMove:function(){k||(removeClass(H,"visible"),removeClass(T,"visible")),k=!0},onZoom:function(){A||(removeClass(H,"visible"),removeClass(T,"visible")),A=!0},onTouchEnd:function(){k||(toggleClass(H,"visible"),toggleClass(T,"visible")),k=A=!1}};break;default:M={hScroll:!1}}scroll[X]=m?new iScroll(_,M):{refresh:noop,scrollTo:noop}}var P=function(){var e=location.hash.slice(1);if(/^animes/i.test(e)){var o=e.split("-"),t=o[1],r=o[2];loadAnimes(t,r);var n=g.querySelector("a.checked");n&&removeClass(n,"checked");var s=g.querySelector('a[href="#'+e+'"]');addClass(s,"checked"),f.innerHTML=r.replace(/\b[a-z]/g,function(e){return e.toUpperCase()})+" "+t}else $show(v),$hide(x),y.innerHTML="",$hide(loading),scroll.home.refresh(),f.innerHTML="Kanade";S.click()};if(e.addEventListener("hashchange",P,!1),m){var W=o.body,N=function(){W.style.height=screen.height+"px",setTimeout(function(){p();
var t=e.innerHeight,r=o.querySelector("header").offsetHeight;for(var n in page){var s=page[n],l=s.querySelector(".scroll");s.style.height=t+"px";var a="image"==n?t:t-r;l.style.height=l.firstElementChild.style.minHeight=a+"px"}for(var n in scroll)scroll[n].refresh()},50)};N(),setTimeout(N,1e3),o.addEventListener("touchend",p,!1),e.addEventListener("orientationchange",N,!1)}microAjax("seasons.json",function(e){if(e=JSON.parse(e),e&&e.seasons){u=e.seasons;var o="";for(var t in u){var r=u[t];for(var n in r){var s=r[n].length;o+='<li><a href="#animes-'+t+"-"+n+'"><b></b>'+n.replace(/\b[a-z]/g,function(e){return e.toUpperCase()})+" "+t+" <span>"+s+"</span></a></li>"}}g.innerHTML+=o,scroll.seasons.refresh(),$show(b),tappable("#seasons-button",{noScroll:!0,onTap:function(){var e=page.seasons;$show(e),removeClass(e,"out"),removeClass(e,"reverse"),addClass(e,"slideup in");var o=e.querySelector(".checked");o&&scroll.seasons.scrollToElement(o)}}),tappable("#close-seasons",{noScroll:!0,onTap:function(){var e=page.seasons;removeClass(e,"in"),addClass(e,"slideup out reverse")}}),P()}}),tappable("#close-image",{noScroll:!0,onTap:function(){var e=page.image;removeClass(e,"in"),addClass(e,"out reverse"),setTimeout(function(){e.querySelector(".scroll div").innerHTML=""},350)}})}(window,document);
//@ sourceMappingURL=kanade.min.js.map